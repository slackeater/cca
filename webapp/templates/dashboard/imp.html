{% extends "dashboard/dash.html" %}

{% block js %}
<script type="text/javascript">
function showReport(up,ci){
	Dajaxice.importer.showReport(showReportCallBack,{'up':up,'ci':ci})
}

function showReportCallBack(data){
	Dajax.process(data)
	$("#repStatus").fadeIn("slow")
	$("#reportTable").fadeIn("slow")
}
</script>
{% endblock %}

{% block content %}



{% if form %}
<h2>Import a report</h2>
<form method='post' action='/importer/{{objID}}/' id="upForm" enctype="multipart/form-data">
	{% csrf_token %}
	<table><tr>
	{% for field in form %}
			<td>{{ field }}</td>
	{% endfor %}
	</tr>	
	<tr><td><input type='submit' value='upload' /></td></tr>
	</tr></table>
</form>
{% endif %}

<div id="parseStatus">{{parseStatus}}</div>

<h2>Report</h2>

<table id="listReportTable">
	<tr><td>ID</td><td>Date</td><td>IP</td><td>Parsed</td></tr>
	
	{% for report in repList %}
	<tr><td><a href="javascript:void(0)" onclick="showReport('{{report.id}}','{{objID}}')">{{ report.fileName }}</a></td><td>{{ report.uploadDate }}</td><td>{{ report.uploadIP }}</td><td>{{ report.parsed }}</td></tr>
	{% endfor %}
</table>

<div id="repStatus" style="display: none"></div>
<div id="reportTable" style="display: none"></div>
{% endblock %}

